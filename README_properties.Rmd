---
title: 'Properties of applied functions'
output: md_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE, 
  comment = NA,
  tidy = TRUE
  )
library(tidyverse)
```

The used functions do not behave equal for all parameter settings. 
Examples are provided for the commutativity and the transitive law.
This affects for example the cardinality of the joined sets.
Moreover, if the distribution of the combinations within a set is studied, it should be taken into account if each feature is counted or each combination (e.g. $A=\{(a_{1},b_{1}),(a_{1},b_{2})\}$).


## Laws to consider for bedtools closest
```{bash, echo=TRUE}
cat example/A.bed
```
```{bash, echo=TRUE}
cat example/B.bed
```

### Commutative property

The nearest neighbor function is not commutative for all parameter settings.

```{bash, echo=TRUE}
bedtools closest -D a -a example/A.bed -b example/B.bed
```


```{bash, echo=TRUE}
bedtools closest -D a -a example/B.bed -b example/A.bed
```

Therefore it is necessary to consider the symmetry of the used parameters.
For example by using `ignore overlap`, `ignore downstream` and `ignore upstream`,
```{bash, echo=TRUE}
bedtools closest -D a -io -iu -a example/A.bed -b example/B.bed
```


```{bash, echo=TRUE}
bedtools closest -D a -io -id -a example/B.bed -b example/A.bed
```

or by enumerating the complete environment of a feature.

```{bash, echo=TRUE}
bedtools closest -D a -k 2 -a example/A.bed -b example/B.bed
```


```{bash, echo=TRUE}
bedtools closest -D a -k 2 -a example/B.bed -b example/A.bed
```

